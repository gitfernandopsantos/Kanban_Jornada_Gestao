<p-sidebar *ngIf="formValue" #sidebar [(visible)]="parent.sidebarVisible" position="right" [baseZIndex]="10000"
    styleClass="w-full md:w-8 lg:w-6 xl:w-5" [showCloseIcon]="false">
    <ng-template pTemplate="content">
        <form (submit)="onSave($event)">
            <div
                class="px-4 py-6 border-bottom-1 surface-border flex align-items-center justify-content-between h-4rem">
                <p-inplace #inplace [closable]="true" closeIcon="pi pi-check" styleClass="h-3rem"
                    (onActivate)="focus(1)" styleClass="white-space-nowrap">
                    <ng-template pTemplate="display">
                        <span class="block text-900 font-semibold text-lg pl-2"
                            pTooltip="Click to edit">{{formValue.title ? formValue.title : 'Untitled'}}</span>
                    </ng-template>
                    <ng-template pTemplate="content">
                        <input #inputTitle type="text" name="title" [(ngModel)]="formValue.title" pInputText
                            class="w-13rem sm:w-18rem h-3rem text-900 text-lg" (keydown.enter)="inplace.deactivate()">
                    </ng-template>
                </p-inplace>
                <div class="flex">
                    <button pButton pRipple type="button" icon="pi pi-times"
                        class="p-button-rounded p-button-text p-button-secondary" (click)="close()"></button>
                </div>
            </div>
            <div class="grid grid-nogutter gap-5 pt-5 flex-wrap flex-1 flex flex-column">
                <div class="col-12 field px-5">
                    <label for="start" class="block text-900 font-semibold">Descrição</label>
                    <textarea id="description" name="description" type="text" pInputTextarea [rows]="5"
                        [(ngModel)]="formValue.description" style="resize: none" class="w-full"></textarea>
                </div>
                <div class="col-12 px-5 flex gap-5">
                    <div class="flex flex-column field w-full">
                        <label for="start" class="block text-900 font-semibold">Data Inicio</label>
                        <span class="p-input-icon-left w-full" style="height: 3.5rem;">
                            <i class="pi pi-clock z-1" style="left: 1.5rem;"></i>
                            <p-calendar name="startDate" [appendTo]="sidebar" dateFormat="yy-mm-dd" [showTime]="false"
                                [required]="true" inputId="start" inputStyleClass="w-full pl-7 text-900 font-semibold"
                                styleClass="w-full" [inputStyle]="{'height':'3.5rem'}"
                                [(ngModel)]="formValue.startDate"></p-calendar>
                        </span>
                    </div>
                    <div class="flex flex-column field w-full">
                        <label for="due" class="block text-900 font-semibold">Data Fim</label>
                        <span class="p-input-icon-left w-full" style="height: 3.5rem;">
                            <i class="pi pi-clock z-1" style="left: 1.5rem;"></i>
                            <p-calendar name="endDate" [appendTo]="sidebar" dateFormat="yy-mm-dd" [showTime]="false"
                                [required]="true" inputId="due" inputStyleClass="w-full pl-7 text-900 font-semibold"
                                styleClass="w-full" [inputStyle]="{'height':'3.5rem'}"
                                [(ngModel)]="formValue.dueDate"></p-calendar>
                        </span>
                    </div>
                </div>


                <div *ngIf="formValue.taskList.tasks.length || showTaskContainer" class="col-12 flex flex-column px-5">
                    <div class="h-4rem -mb-4">
                        <p-inplace #inplace2 [closable]="true" closeIcon="pi pi-check" styleClass="h-4rem"
                            (onActivate)="focus(2)">
                            <ng-template pTemplate="display">
                                <span class="block text-900 font-semibold text-lg mt-3" pTooltip="Click to edit"
                                    tooltipPosition="left">{{formValue.taskList.title}}</span>
                            </ng-template>
                            <ng-template pTemplate="content">
                                <input #inputTaskListTitle type="text" name="title"
                                    [(ngModel)]="formValue.taskList.title" pInputText
                                    class="w-20rem h-3rem text-900 mt-2 text-lg"
                                    (keydown.enter)="inplace2.deactivate()">
                            </ng-template>
                        </p-inplace>
                    </div>
                    <textarea type="text" pInputTextarea name="taskContent" [(ngModel)]="taskContent"
                        style="resize: none" class="w-full mt-4" placeholder="Add a task"
                        (keydown.enter)="addTask($event)"></textarea>

                    <ul *ngIf="formValue.taskList?.tasks?.length !== 0"
                        class="list-none p-4 flex flex-column gap-3 surface-ground surface-border border-1 border-round">
                        <li class="flex align-items-start gap-3"
                            *ngFor="let task of formValue.taskList?.tasks;let i=index">
                            <p-checkbox [name]="task.text + i" [(ngModel)]="task.completed" [binary]="true"
                                [inputId]="task.text" (onChange)="calculateProgress()"></p-checkbox>
                            <span style="word-break: break-all;"
                                [ngClass]="{'text-600 line-through': task.completed, 'text-900': !task.completed}">
                                {{task.text}}
                            </span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="flex w-full justify-content-end border-top-1 surface-border py-5 px-5 gap-3">
                <button pButton pRipple type="button" icon="pi pi-trash"
                    class="p-button-outlined p-button-secondary surface-border text-900 w-3rem h-3rem"
                    (click)="onDelete()"></button>
                <button pButton pRipple type="submit" icon="pi pi-check" label="Salvar"
                    class="p-button-primary h-3rem"></button>
            </div>
        </form>
    </ng-template>
</p-sidebar>